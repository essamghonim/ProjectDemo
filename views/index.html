<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
        <title>Dashboard</title>

        <link href='http://fonts.googleapis.com/css?family=Raleway:400,700' rel='stylesheet' type='text/css'>
        <!-- font awesome -->
        <link rel="stylesheet" href="css/font-awesome/css/font-awesome.min.css">
        <!-- Bootstrap -->
        <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="css/superslide/superslides.css">
        <link rel="stylesheet" href="css/fancybox/jquery.fancybox.css">
        <link rel="stylesheet" href="css/nivo-lightbox/nivo-lightbox.css">
        <link rel="stylesheet" href="css/themes/default/default.css">
        <link rel="stylesheet" href="css/responsive.css">
        <link rel="stylesheet" href="css/animate/animate.css">
        <link rel="stylesheet" href="css/owl-carousel/owl.carousel.css">
        <link rel="stylesheet" href="css/owl-carousel/owl.theme.css">
        <link rel="stylesheet" href="css/owl-carousel/owl.transitions.css">
        <link href='https://fonts.googleapis.com/css?family=Titillium+Web:400,300,600' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
        <link rel="stylesheet" href="css/MyWebsite.css">
        <script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
        <script  src="js/sign.js"></script>
        <script src="js/jquery/jquery.js"></script>
        <script src="js/script.js"></script>
        <script src="js/bootstrap/bootstrap.min.js"></script>
        <script src="js/fancybox/jquery.fancybox.pack.js"></script>
        <script src="js/nivo-lightbox/nivo-lightbox.min.js"></script>
        <script src="js/owl-carousel/owl.carousel.min.js"></script>
        <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBL6gbhsnCEt4FS9D6BBl3mZO1xy-NcwpE&sensor=false"></script>
        <script src="js/jquery-easing/jquery.easing.1.3.js"></script>
        <script src="js/superslide/jquery.superslides.js"></script>
        <script src="js/wow/wow.min.js"></script>
    </head>
    <body>
		<div class='preloader'><div class='loaded'>&nbsp;</div></div>
        <header id="home" class="header navbar-fixed-top">
            <div class="navbar navbar-default main-menu">

                <div class="container">
                    <div class="navbar-header">
                        <a  href="#" style="margin-top: 150px; font-weight: bold; font-size: 30px; color: #162D3D;text-decoration: none; text-align: center; vertical-align: middle; line-height: 90px;">Willi</a>
                    </div>
                    <div class="collapse navbar-collapse">
                        <ul class="nav navbar-nav navbar-right">
                            <li><a href="dashboard.html" class=""><font color="#162D3D"><b><strong>My Websites</strong></b></font></a></li>
                            <li><a href="alltemplates.html" class=""><font color="#162D3D"><b><strong>Create new website</strong></b></font></a></li>
                            <li><a href="#" class=""><font color="#162D3D"><b><strong>Support</strong></b></font></a></li>
                            <li><a href="#" class=""><font color="#162D3D"><b><strong>Account</strong></b></font></a></li>
                        </ul>

                    </div>
                </div>
            </div> <!-- end of navbar -->
        </header>
    <section id="fh5co-work" data-section="work">
        <div class="container">
            <div class="row">
                    <h2 class="to-animate"><font color="#FFFFFF">My Websites</font></h2>
            </div>
            <div class="row row-bottom-padded-sm" id="templaterow">
            </div>
        </div>
    </section>
    <script>
    GenerateRows();
    function GenerateRows()
    {
        $.ajax({
            url: 'api/getMyWebsites?Email=' + sessionStorage.getItem('email'),
            headers: { 'token': sessionStorage.getItem('token'), 'Email': sessionStorage.getItem('email')},
            type: 'GET',
            success: function(response) {
                console.log("Here is the response " + JSON.stringify(response));
                var status = response['status'];
                if(status == 200)
                {
                    var results = JSON.parse(response['result']);
                    var templaterow = document.getElementById("templaterow");
                    var NumberOfRows = 9;
                    var WhichPage = sessionStorage.getItem('WhichPage');
                    if (WhichPage == null)
                    {
                        WhichPage = 1;
                    }
                    if (WhichPage == 4)
                    {
                        NumberOfRows = 6;
                    }
                    var CalculationNum = (WhichPage-1)*9;
                    var TotalNum = 0;
                    console.log(results.length);
                    if (results.length < NumberOfRows)
                    {
                        NumberOfRows = results.length
                    }
                    if (NumberOfRows)
                    {
                        sessionStorage.setItem('NumOfWebsites', NumberOfRows+1);
                    }
                    else
                    {
                        sessionStorage.setItem('NumOfWebsites', 1);
                    }
                     for(count = 0; count < NumberOfRows; count++)
                     {
                        TotalNum = results[count]['ID'];
                        var div = document.createElement("div");
                        div.className = 'col-md-4 col-sm-6 col-xxs-12';
                        var a = document.createElement("a");
                        a.className = 'fh5co-project-item image-popup to-animate';
                        //a.href = "Templates/" + TotalNum + "/index.html";
                        var img = document.createElement("img");
                        img.src = "images/Templates/" + TotalNum + ".png";
                        img.className = "img-responsive";
                         var createClickHandler = 
                            function(row) 
                            {
                                return function() 
                                { 
                                    console.log("row clicked " + row);
                                    sessionStorage.setItem('EditingPage', (row+1));
                                    sessionStorage.setItem('PageName', document.getElementById('Project'+row).innerHTML);
                                    //document.location = "Templates/" + (row+1) + "/index.html";
                                    document.location = "siteInfo.html";
                                };
                            };        
                         img.onclick = createClickHandler(count);
                        var Innerdiv = document.createElement("div");
                        Innerdiv.className = 'fh5co-text';
                        var button = document.createElement("input");
                        button.value = 'Edit';
                        button.setAttribute("style", "background-color: #47AFD0; float: right; width:80px; color: #ffffff; border: 2px solid; border-radius: 25px; margin-bottom: 10px;");
                        button.type = "button";
                         var createClickHandler = 
                            function(row) 
                            {
                                return function() 
                                { 
                                    console.log("row clicked " + document.getElementById('Project'+row).innerHTML);
                                    sessionStorage.setItem('EditingPage', (row+1));
                                    sessionStorage.setItem('PageName', document.getElementById('Project'+row).innerHTML);
                                    document.location = "siteInfo.html";
                                };
                            };        
                         button.onclick = createClickHandler(count);
                        var h2 = document.createElement("h2");
                        if (results[count]['webname'])
                        {
                            h2.innerHTML = results[count]['webname'];
                        }
                        else
                        {
                            h2.innerHTML = 'Project ' + TotalNum;
                        }
                        h2.id = "Project" + count;
                        var span = document.createElement("span");
                        span.innerHTML = 'Branding';
                        Innerdiv.appendChild(h2);
                        Innerdiv.appendChild(span);
                        Innerdiv.appendChild(button);
                        a.appendChild(img);
                        a.appendChild(Innerdiv);
                        div.appendChild(a);
                        if (count == 2 || count == 4 || count == 6 || count == 8)
                        {
                            var Extradiv = document.createElement("div");
                            Extradiv.className = 'clearfix visible-sm-block';
                            templaterow.appendChild(Extradiv);
                        }
                        templaterow.appendChild(div);
                     }
                }
                else if (status == 404)
                {
                    var templaterow = document.getElementById("templaterow");
                    var p = document.createElement("p");
                    p.innerHTML = "No websites found";
                    templaterow.appendChild(p);

                }
            }
        });
    }
    </script>


    </body>
</html>